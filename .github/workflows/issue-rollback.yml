name: Issue Rollback
on:
  workflow_dispatch:
    inputs:
      issue_number:
        description: "Issue number to reopen"
        required: true
jobs:
  reopen:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Reopen issue
        uses: actions/github-script@v7
        env:
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
        with:
          script: |
            const core = require('@actions/core');
            const token = process.env.BOT_TOKEN;
            const octo = github.getOctokit(token);
            const { owner, repo } = context.repo;
            const issue_number = Number(core.getInput('issue_number'));
            if (!issue_number || Number.isNaN(issue_number)){
              core.setFailed('Invalid issue_number input');
              return;
            }
            const got = await octo.rest.issues.get({ owner, repo, issue_number });
            if (got.data.state === 'open'){
              core.notice(`Issue #${issue_number} already open`);
              return;
            }
            await octo.rest.issues.update({ owner, repo, issue_number, state: 'open' });
            core.notice(`Issue reopened: #${issue_number}`);

